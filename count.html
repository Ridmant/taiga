<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
renderTableRows = function(rows) {
	let result = ""
	for(row in rows) {
		result += "<tr><td>" + row + "</td><td>" + rows[row] + "</td></tr>"
	}
	return result
}
categories = {
1: '«Коплю на Феррари» (Засольщик ЕП)',
2: '«60ый на 60ом» (6фаза 60лвл 60%маунт)',
3: '«Любимчик РЛа»',
4: '«Лучший ГМ гильдии»',
5: '«Найс забафался» (Солил бафы всю неделю – умер на первом паке)',
6: '«Майнкрафтер» (Кому чаще всего вы обращаетесь за крафтом)',
7: '«Кукловод» (Лучший МКашер)',
8: '«Овощ года» (Кто чаще всего косячит в рейде – умирает в войдзонах, падает с трубы и тп)',
9: '«Милота года»',
10: '«Самый приятный голос»',
11: '«Откройте форточку» (Самый душный)',
12: '«Папина радость, мамина сладость» (Самый молодой)',
13: '«Мамкин ПВПшер»',
14: '«Суммонь меня мразь» (Лучший суммонер, вспомните когда у вас тикали бафы)',
15: '«Урод года»',
}
mapping = {
	Квадра: 'Квадралень',
	Квадро: 'Квадралень',
	Кайлисс: 'Ньярлототеп',
	Эллтарион: 'Элтарион',
	Ким: 'Кимсан',
	Кимсани: 'Кимсан',
	Беласнежка: 'Белласнежка',
	Аллинель: 'Алиннель',
	Алинель: 'Алиннель',
	Рдига : 'Рдигга',
	Даорит: 'Даоритт',
	Проц: 'Процессорша',
	Ноизия: 'Вавакинг',
	Ноизя: 'Вавакинг',
	Вава : 'Вавакинг',
 	Орнич: 'Орни',
	боряныч: 'Вавакинг',
	басон: 'Басон',
	Трогвар : 'Тррогвар',
	силма : 'Сильмариллион',
	даорит: 'Даоритт',
	Белла: 'Белласнежка',
	кекторная: 'Векторная',
	приправа: 'Приправыч',
	кимсан: 'Кимсан', 
	элтарион: 'Элтарион',
	хиба: 'Хиба',
}
legalNames = [
	'Квадралень',
	'Ньярлототеп',
	'Элтарион',
	'Кимсан',
	'Белласнежка',
	'Алиннель',
	'Сильмариллион',
	'Эрз',
	'Амдо',
	'Векторная',
	'Ридмант',
	'Джоська',
	'Приправыч',
	'Василий',
	'Холифренд',
	'Хилка',
	'Трумалина',
	'Басон',
	'Хамик',
	'Вавакинг',
	'Фаора',
	'Диаспра',
	'Давайдунем',
	'Киссмайэсс',
	'Амдолеру',
	'Рдигга',
	'Вжухблинк',
	'Процессорша',
	'Крайтен',
	'Ненсис',
	'Дуккха',
	'Бобр',
	'Ластархангел',
	'Хиба',
	'Нарракет',
	'Дирхаэль',
	'Орни',
	'Пенталгин',
	'Тррогвар',
	'Скарадрим',
	'Аъуе',
	'Фоджик',
	'Даоритт',
]
correctName = function(name, line) {
	result = name
	mapped = mapping[name];
	if (mapped) {
		result = mapped
	}
	if (!legalNames.includes(result)) {
		result = '<span color="red">' + line + '</span>'
	}
	return result
}
count = function() {
	let data = $('#input').val();
	lines = data.split("\n")
	errors = [];
	results = []
	for (i = 1; i <= 15; i++) {
		results[i] = {}
	}
	for (let line of lines) {
		if (line.includes('— Сегодня, в')) {
			continue;
		}
		let match = line.match(/\D*(\d+)[^-–]*[-–]([^а-яА-Я]*([а-яА-Я]+).*)/)
		if (!match) {
				errors.push(line)
		} else {
			try {
				let name = correctName(match[3], match[2])  
				results[match[1]][name] = 1 + (results[match[1]][name] || 0);
			} catch (ex) {
				errors.push(line)				
			}
		}
	}
	$('#errors').html(errors.join("<br>"))
	render = "";
	for (i = 1; i <= 15; i++) {
		render += categories[i] + "</br>"
		render += "<table>" + renderTableRows(results[i]) + "<table><br>"
	}
	$('#results').html(render)
}
</script>
</head>
<body>
<textarea id="input"></textarea>
<BR>
<button onClick="count()">count</button>
<div id="errors" style="color: red; font-size: 20" > </div>
<div id="results" style="color: black; font-size: 20">  </div>
</body>
</html>